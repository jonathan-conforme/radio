<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Guayaco FM</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
  </head>

  <body class="bg-gradient-to-br from-black via-gray-900 to-gray-800 text-white min-h-screen flex items-center justify-center">
    <div class="w-full max-w-md text-center px-6">

      <!-- LOGO -->
      <h1 class="text-5xl font-extrabold mb-2 tracking-tight">
        <span class="text-[#2AA4D9]">GUAYACO</span>
        <span class="text-[#075985]">FM</span>
      </h1>

      <p class="text-gray-300 mb-8">Humor ğŸ™ï¸ Â· MÃºsica ğŸ¶ Â· Cero vergÃ¼enza</p>

      <!-- PLAYER CARD -->
      <div class="bg-gray-900 rounded-2xl p-6 shadow-xl">

        <!-- STATUS -->
        <p id="statusText" class="text-sm text-green-400 mb-3">ğŸŸ¢ EN VIVO</p>

        <!-- AUDIO -->
        <audio
          id="radio"
          src="http://localhost:8000/radio"
          crossorigin="anonymous"
          preload="none"
        ></audio>

        <!-- SELECTOR DE FUENTE -->

        <!-- CUSTOM PLAYER -->
        <div class="bg-white rounded-full flex items-center gap-4 px-5 py-3 shadow-lg">
          <!-- PLAY BUTTON -->
          <button
            id="playBtn"
            aria-label="Reproducir radio"
            class="w-12 h-12 rounded-full bg-[#2AA4D9] text-white text-xl flex items-center justify-center shadow-lg shadow-[#2AA4D9]/40 hover:bg-[#1d8bbf] transition animate-pulse"
          >
            â–¶ï¸
          </button>

          <!-- LIVE INDICATOR BAR -->
          <div class="flex-1 h-2 bg-gray-200 rounded-full overflow-hidden">
            <div id="liveBar" class="h-full bg-[#075985] w-0 transition-all duration-500"></div>
          </div>

          <span class="text-sm font-semibold text-gray-600">LIVE</span>
        </div>

        <p class="text-xs text-gray-400 mt-4">Si desafinamos, es parte del show ğŸ˜</p>
      </div>

      <!-- SOCIALS -->
      <div class="flex justify-center gap-6 mt-8 text-sm text-gray-300">
        <a href="#" class="hover:text-white transition">TikTok</a>
        <a href="#" class="hover:text-white transition">Instagram</a>
        <a href="#" class="hover:text-white transition">YouTube</a>
      </div>
    </div>

    <!-- JS -->
    <script>
      const radio = document.getElementById("radio");
      const playBtn = document.getElementById("playBtn");
      const statusText = document.getElementById("statusText");
      const liveBar = document.getElementById("liveBar");
      const sourceSelect = document.getElementById("sourceSelect");

      let playing = false;
      let barInterval = null;

      function startLiveBar() {
        liveBar.style.width = "100%";
        barInterval = setInterval(() => {
          liveBar.style.width = "0%";
          setTimeout(() => {
            liveBar.style.width = "100%";
          }, 300);
        }, 1500);
      }

      function stopLiveBar() {
        clearInterval(barInterval);
        liveBar.style.width = "0%";
      }

      playBtn.addEventListener("click", () => {
        if (!playing) {
          radio.play().catch(err => console.log("Error reproduciendo el stream:", err));
          playBtn.innerText = "â¸ï¸";
          playBtn.classList.remove("animate-pulse");
          statusText.innerText = "ğŸ”Š SONANDO";
          startLiveBar();
        } else {
          radio.pause();
          playBtn.innerText = "â–¶ï¸";
          playBtn.classList.add("animate-pulse");
          statusText.innerText = "ğŸŸ¢ EN VIVO";
          stopLiveBar();
        }
        playing = !playing;
      });

      // Cambiar fuente de radio
      sourceSelect.addEventListener("change", () => {
        const wasPlaying = playing;
        radio.src = sourceSelect.value;
        if (wasPlaying) {
          radio.play().catch(err => console.log("Error reproduciendo el stream:", err));
        }
      });
    </script>
  </body>
</html>
